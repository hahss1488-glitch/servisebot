import os
BOT_TOKEN = os.getenv("SERVICEBOT_TOKEN")

# ========== –ù–ê–°–¢–†–û–ô–ö–ò –ù–û–ú–ï–†–û–í ==========

# –ü–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö –±—É–∫–≤ —Ä—É—Å—Å–∫–∏–º
ENG_TO_RUS = {
    # –ü–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É –†–§
    'A': '–ê',  # –õ–∞—Ç–∏–Ω—Å–∫–∞—è A ‚Üí –†—É—Å—Å–∫–∞—è –ê
    'B': '–í',  # –õ–∞—Ç–∏–Ω—Å–∫–∞—è B ‚Üí –†—É—Å—Å–∫–∞—è –í
    'C': '–°',  # –õ–∞—Ç–∏–Ω—Å–∫–∞—è C ‚Üí –†—É—Å—Å–∫–∞—è –°
    'E': '–ï',  # –õ–∞—Ç–∏–Ω—Å–∫–∞—è E ‚Üí –†—É—Å—Å–∫–∞—è –ï
    'H': '–ù',  # –õ–∞—Ç–∏–Ω—Å–∫–∞—è H ‚Üí –†—É—Å—Å–∫–∞—è –ù (–≤–∞–∂–Ω–æ!)
    'K': '–ö',  # –õ–∞—Ç–∏–Ω—Å–∫–∞—è K ‚Üí –†—É—Å—Å–∫–∞—è –ö
    'M': '–ú',  # –õ–∞—Ç–∏–Ω—Å–∫–∞—è M ‚Üí –†—É—Å—Å–∫–∞—è –ú
    'O': '–û',  # –õ–∞—Ç–∏–Ω—Å–∫–∞—è O ‚Üí –†—É—Å—Å–∫–∞—è –û
    'P': '–†',  # –õ–∞—Ç–∏–Ω—Å–∫–∞—è P ‚Üí –†—É—Å—Å–∫–∞—è –†
    'T': '–¢',  # –õ–∞—Ç–∏–Ω—Å–∫–∞—è T ‚Üí –†—É—Å—Å–∫–∞—è –¢
    'X': '–•',  # –õ–∞—Ç–∏–Ω—Å–∫–∞—è X ‚Üí –†—É—Å—Å–∫–∞—è –• (–≤–∞–∂–Ω–æ!)
    'Y': '–£',  # –õ–∞—Ç–∏–Ω—Å–∫–∞—è Y ‚Üí –†—É—Å—Å–∫–∞—è –£ (–≤–∞–∂–Ω–æ!)
}

# –†—É—Å—Å–∫–∏–µ –±—É–∫–≤—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –Ω–æ–º–µ—Ä–∞—Ö –†–§
RUS_LETTERS = "–ê–í–ï–ö–ú–ù–û–†–°–¢–£–•"

# –û–±—Ä–∞—Ç–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ (—Ä—É—Å—Å–∫–∏–µ ‚Üí –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ, –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
RUS_TO_ENG = {rus: eng for eng, rus in ENG_TO_RUS.items()}

# –†–µ–≥–∏–æ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å)
DEFAULT_REGION = "797"

# –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –±—É–∫–≤—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –Ω–æ–º–µ—Ä–∞—Ö
ALLOWED_LETTERS = RUS_LETTERS  # –ü—Ä–æ—Å—Ç–æ —Å—Å—ã–ª–∞–µ–º—Å—è –Ω–∞ RUS_LETTERS

# ========== –ü–†–ê–ô–°-–õ–ò–°–¢ ==========

SERVICES = {
    1: {"name": "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞", "day_price": 115, "night_price": 92, "priority": 1, "order": 1},
    2: {"name": "‚õΩ –ó–∞–ø—Ä–∞–≤–∫–∞ –¢–°", "day_price": 198, "night_price": 158, "priority": 1, "order": 2},
    3: {"name": "üß¥ –ó–∞–ª–∏–≤–∫–∞ –æ–º—ã–≤–∞–π–∫–∏", "day_price": 66, "night_price": 55, "priority": 1, "order": 3},
    4: {"name": "üöó –ü–µ—Ä–µ–≥–æ–Ω –¢–° –Ω–∞ –¢–û", "day_price": 254, "night_price": 203, "priority": 1, "order": 4},
    5: {"name": "üì° –ù–µ—Ç —Å–ø—É—Ç–Ω–∏–∫–∞", "day_price": 398, "night_price": 315, "priority": 1, "order": 5},
    6: {"name": "‚ö° –°—Ä–æ—á–Ω—ã–π –≤—ã–µ–∑–¥", "day_price": 220, "night_price": 174, "priority": 1, "order": 6},
    7: {"name": "üîã –ó–∞—Ä—è–¥–∫–∞ –ê–ö–ë", "day_price": 125, "night_price": 98, "priority": 2, "order": 1},
    8: {"name": "üèÅ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–ª–∏—Ç. –∞—Ä–µ–Ω–¥", "day_price": 93, "night_price": 74, "priority": 2, "order": 2},
    9: {"name": "üß™ –î–æ–ª–∏–≤ —Ç–µ—Ö. –∂–∏–¥–∫–æ—Å—Ç–µ–π", "day_price": 77, "night_price": 66, "priority": 2, "order": 3},
   10: {"name": "üõ£Ô∏è –î–∞–ª—å–Ω—è–∫", "day_price": 0, "night_price": 0, "priority": 2, "order": 4, "kind": "distance", "rate_per_km": 7},
    11: {"name": "üöô –î–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–µ–∑–¥–∫–∏ (—Å–ø–∏—Å–æ–∫)", "priority": 2, "order": 5, "kind": "group", "children": [30, 31, 32, 33]},
    12: {"name": "üßæ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ß–µ–∫", "day_price": 50, "night_price": 39, "priority": 3, "order": 1},
    13: {"name": "üõû –ü–æ–¥–∫–∞—á–∫–∞ –∫–æ–ª–µ—Å–∞", "day_price": 75, "night_price": 59, "priority": 3, "order": 2},
    14: {"name": "üÖøÔ∏è –ü–µ—Ä–µ–ø–∞—Ä–∫–æ–≤–∫–∞ –¢–°", "day_price": 150, "night_price": 118, "priority": 3, "order": 3},
    15: {"name": "üß∞ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ö–æ–¥–æ–≤–æ–π", "day_price": 115, "night_price": 92, "priority": 3, "order": 4},
    16: {"name": "üö´ –•–æ–ª–æ—Å—Ç–æ–π –≤—ã–µ–∑–¥", "day_price": 64, "night_price": 55, "priority": 3, "order": 5},
    17: {"name": "üî© –ü—Ä–æ—Ç—è–∂–∫–∞ –∫–æ–ª–µ—Å–Ω—ã—Ö –±–æ–ª—Ç–æ–≤", "day_price": 92, "night_price": 74, "priority": 3, "order": 6},
    18: {"name": "üß± –°—É–≥—Ä–æ–± –ø—Ä–æ—Å—Ç–æ–π", "day_price": 160, "night_price": 126, "priority": 4, "order": 1},
    19: {"name": "üßä –°—É–≥—Ä–æ–± —Å–ª–æ–∂–Ω—ã–π", "day_price": 902, "night_price": 686, "priority": 4, "order": 2},
    20: {"name": "üìÑ –í–ª–æ–∂–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤", "day_price": 31, "night_price": 25, "priority": 4, "order": 3},
    21: {"name": "‚öôÔ∏è –ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è", "day_price": 83, "night_price": 64, "priority": 4, "order": 4},
    22: {"name": "üí° –ó–∞–º–µ–Ω–∞ –ª–∞–º–ø–æ—á–∫–∏", "day_price": 31, "night_price": 25, "priority": 4, "order": 5},
    23: {"name": "ü™™ –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ì–†–ó", "day_price": 31, "night_price": 25, "priority": 4, "order": 6},
    24: {"name": "üîå –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è", "day_price": 101, "night_price": 79, "priority": 4, "order": 7},
    25: {"name": "üßπ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–≤–æ—Ä–Ω–∏–∫–∞", "day_price": 31, "night_price": 25, "priority": 4, "order": 8},
    26: {"name": "ü™û –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–µ—Ä–∫–∞–ª–∞", "day_price": 74, "night_price": 59, "priority": 4, "order": 9},
    27: {"name": "üíß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–æ—Ä—Å—É–Ω–∫–∏ –æ–º—ã–≤–∞—Ç–µ–ª—è", "day_price": 74, "night_price": 59, "priority": 4, "order": 10},
    28: {"name": "üß¢ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–ª–ø–∞–∫–∞ (1 —à—Ç)", "day_price": 27, "night_price": 22, "priority": 4, "order": 11},
    29: {"name": "üõ†Ô∏è –ó–∞–º–µ–Ω–∞ –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª–µ–π", "day_price": 75, "night_price": 59, "priority": 4, "order": 12},
    30: {"name": "‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–µ–∑–¥–∫–∏ –¥–æ 1 —á–∞—Å–∞", "day_price": 149, "night_price": 118, "hidden": True},
    31: {"name": "‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–µ–∑–¥–∫–∏ –¥–æ 3 —á–∞—Å–æ–≤", "day_price": 648, "night_price": 511, "hidden": True},
    32: {"name": "‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–µ–∑–¥–∫–∏ –¥–æ 5 —á–∞—Å–æ–≤", "day_price": 1146, "night_price": 905, "hidden": True},
    33: {"name": "‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–µ–∑–¥–∫–∏ –¥–æ 10 —á–∞—Å–æ–≤", "day_price": 2243, "night_price": 1770, "hidden": True},
    34: {"name": "üë®‚Äçüîß –†–∞–∑–≤–æ–∑ –º–µ—Ö–∞–Ω–∏–∫–æ–≤ (—Å–ø–∏—Å–æ–∫)", "priority": 4, "order": 13, "kind": "group", "children": [35, 36, 37, 38]},
    35: {"name": "üöê –†–∞–∑–≤–æ–∑ –¥–æ 3 —á–∞—Å–æ–≤", "day_price": 373, "night_price": 295, "hidden": True},
    36: {"name": "üöê –†–∞–∑–≤–æ–∑ –¥–æ 5 —á–∞—Å–æ–≤", "day_price": 747, "night_price": 590, "hidden": True},
    37: {"name": "üöê –†–∞–∑–≤–æ–∑ –¥–æ 7 —á–∞—Å–æ–≤", "day_price": 1495, "night_price": 1180, "hidden": True},
    38: {"name": "üöê –†–∞–∑–≤–æ–∑ –æ—Ç 7 —á–∞—Å–æ–≤", "day_price": 2243, "night_price": 1770, "hidden": True},
    39: {"name": "üöö –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –¢–° (—Å–ø–∏—Å–æ–∫)", "priority": 4, "order": 14, "kind": "group", "children": [40, 41, 42, 43, 44]},
    40: {"name": "üöö –° —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –°–¢–û", "day_price": 31, "night_price": 25, "hidden": True},
    41: {"name": "üöö –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –¢–° –¥–æ 20 –∫–º", "day_price": 320, "night_price": 252, "hidden": True},
    42: {"name": "üöö –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –¢–° –æ—Ç 20 –¥–æ 26 –∫–º", "day_price": 543, "night_price": 429, "hidden": True},
    43: {"name": "üöö –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –¢–° –æ—Ç 26 –¥–æ 32 –∫–º", "day_price": 725, "night_price": 572, "hidden": True},
    44: {"name": "üöö –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –¢–° –æ—Ç 32 –∫–º", "day_price": 911, "night_price": 720, "hidden": True},
    45: {"name": "üßæ –ó–∞–ø—Ä–∞–≤–∫–∞ –∏–∑ –∫–∞–Ω–∏—Å—Ç—Ä—ã", "day_price": 278, "night_price": 278, "priority": 4, "order": 15},
    46: {"name": "üßæ –ó–∞–ø—Ä–∞–≤–∫–∞ –∏–∑ –∫–∞–Ω–∏—Å—Ç—Ä—ã (—Å—Ä–æ—á–Ω–æ)", "day_price": 333, "night_price": 332, "priority": 4, "order": 16},
    47: {"name": "üîß –£–¥–∞–ª—ë–Ω–Ω–∞—è –∑–∞–ø—Ä–∞–≤–∫–∞", "day_price": 545, "night_price": 433, "priority": 4, "order": 17},
}

# ========== –§–£–ù–ö–¶–ò–ò –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–ò ==========

def normalize_car_number(text: str) -> str:
    """
    –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞ –º–∞—à–∏–Ω—ã –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É –†–§
    
    –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è:
    - 'x340py' ‚Üí '–•340–†–£797'
    - '—Ö340—Ä—É' ‚Üí '–•340–†–£797'
    - 'H340PY797' ‚Üí '–ù340–†–£797'
    - '–∞123–≤—Å' ‚Üí '–ê123–í–°797'
    - 'b567tx' ‚Üí '–í567–¢–•797'
    """
    if not text:
        return ""
    
    # 1. –ü—Ä–∏–≤–æ–¥–∏–º –∫ –≤–µ—Ä—Ö–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
    text = text.strip().upper()
    
    # 2. –£–¥–∞–ª—è–µ–º –≤—Å–µ –ø—Ä–æ–±–µ–ª—ã, –¥–µ—Ñ–∏—Å—ã –∏ –¥—Ä—É–≥–∏–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏
    text = text.replace(' ', '').replace('-', '').replace('_', '')
    
    # 3. –ó–∞–º–µ–Ω—è–µ–º –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –±—É–∫–≤—ã –Ω–∞ —Ä—É—Å—Å–∫–∏–µ
    result = []
    for char in text:
        # –ï—Å–ª–∏ —ç—Ç–æ –∞–Ω–≥–ª–∏–π—Å–∫–∞—è –±—É–∫–≤–∞ –∏–∑ –Ω–∞—à–µ–≥–æ —Å–ª–æ–≤–∞—Ä—è - –∑–∞–º–µ–Ω—è–µ–º
        if char in ENG_TO_RUS:
            result.append(ENG_TO_RUS[char])
        else:
            # –ò–Ω–∞—á–µ –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å (—Ä—É—Å—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã)
            result.append(char)
    
    normalized = ''.join(result)
    
    # 4. –£–¥–∞–ª—è–µ–º –í–°–ï —Å–∏–º–≤–æ–ª—ã, –∫—Ä–æ–º–µ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö —Ä—É—Å—Å–∫–∏—Ö –±—É–∫–≤ –∏ —Ü–∏—Ñ—Ä
    # –†–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã –∏–∑ RUS_LETTERS –∏ —Ü–∏—Ñ—Ä—ã
    allowed_chars = RUS_LETTERS + '0123456789'
    normalized = ''.join([c for c in normalized if c in allowed_chars])
    
    # 5. –ê–≤—Ç–æ–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
    # –§–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–∞ –†–§: –±—É–∫–≤–∞-—Ü–∏—Ñ—Ä–∞-—Ü–∏—Ñ—Ä–∞-—Ü–∏—Ñ—Ä–∞-–±—É–∫–≤–∞-–±—É–∫–≤–∞
    # –ü—Ä–∏–º–µ—Ä: –ê123–í–°777
    
    # –°—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—É–∫–≤ –∏ —Ü–∏—Ñ—Ä
    letters = sum(1 for c in normalized if c in RUS_LETTERS)
    digits = sum(1 for c in normalized if c.isdigit())
    
    # –ï—Å–ª–∏ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã 3 —Ü–∏—Ñ—Ä—ã –∏ 3 –±—É–∫–≤—ã - —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –Ω–æ–º–µ—Ä –ø–æ–ª–Ω—ã–π
    if digits >= 3 and letters >= 3:
        # –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ —Ü–∏—Ñ—Ä —Ä–æ–≤–Ω–æ 6 (3 –≤ –Ω–æ–º–µ—Ä–µ + 3 –≤ —Ä–µ–≥–∏–æ–Ω–µ)
        if digits < 6:
            # –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ü–∏—Ñ—Ä—ã –∏–∑ —Ä–µ–≥–∏–æ–Ω–∞
            missing_digits = 6 - digits
            normalized += DEFAULT_REGION[:missing_digits]
        return normalized
    
    # –ï—Å–ª–∏ –Ω–æ–º–µ—Ä –∫–æ—Ä–æ—Ç–∫–∏–π (—Ç–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å)
    # –ü—Ä–∏–º–µ—Ä: '–•340–†–£' ‚Üí –¥–æ–±–∞–≤–ª—è–µ–º —Ä–µ–≥–∏–æ–Ω
    if len(normalized) <= 6:
        normalized += DEFAULT_REGION
    
    return normalized

def validate_car_number(text: str) -> tuple[bool, str, str]:
    """
    –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –Ω–æ–º–µ—Ä–∞ –º–∞—à–∏–Ω—ã
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: (is_valid, normalized_number, error_message)
    
    –í–∞–ª–∏–¥–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:
    - –ê123–í–°777
    - –•340–†–£797
    - –ê123–í–° (–¥–æ–±–∞–≤–∏—Ç—Å—è —Ä–µ–≥–∏–æ–Ω)
    - X340PY (–¥–æ–±–∞–≤–∏—Ç—Å—è —Ä–µ–≥–∏–æ–Ω, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ —Ä—É—Å—Å–∫–∏–µ)
    """
    if not text:
        return False, "", "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –º–∞—à–∏–Ω—ã"
    
    # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –Ω–æ–º–µ—Ä
    normalized = normalize_car_number(text)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–ª–∏–Ω—É
    if len(normalized) < 6:
        return False, normalized, f"–ù–æ–º–µ—Ä —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π: {normalized}"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: –±—É–∫–≤–∞-3 —Ü–∏—Ñ—Ä—ã-2 –±—É–∫–≤—ã-3 —Ü–∏—Ñ—Ä—ã
    import re
    pattern = f'^[{RUS_LETTERS}]\\d{{3}}[{RUS_LETTERS}]{{2}}\\d{{3}}$'
    
    if not re.match(pattern, normalized):
        # –ü–æ–ø—Ä–æ–±—É–µ–º —á–∞—Å—Ç–∏—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: –±—É–∫–≤–∞-3 —Ü–∏—Ñ—Ä—ã-2 –±—É–∫–≤—ã
        partial_pattern = f'^[{RUS_LETTERS}]\\d{{3}}[{RUS_LETTERS}]{{2}}$'
        if re.match(partial_pattern, normalized):
            # –≠—Ç–æ —á–∞—Å—Ç–∏—á–Ω—ã–π –Ω–æ–º–µ—Ä, –¥–æ–±–∞–≤–ª—è–µ–º —Ä–µ–≥–∏–æ–Ω
            normalized = normalized + DEFAULT_REGION
            # –¢–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
            if re.match(pattern, normalized):
                return True, normalized, ""
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
        return False, normalized, "–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ü—Ä–∏–º–µ—Ä: –ê123–í–°777"
    
    return True, normalized, ""

def get_correct_examples() -> str:
    """–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è"""
    examples = [
        "–ê123–í–°777",
        "–•340–†–£797", 
        "–í567–¢–•799",
        "–ï234–ö–ú777",
        "–ú890–†–¢799",
        "–û567–°–¢799",
        "–†123–¢–•777",
        "–°456–í–ï797",
        "–¢789–ê–ö799",
        "–£012–ù–•777"
    ]
    
    input_examples = [
        ("x340py", "‚Üí –•340–†–£797"),
        ("—Ö340—Ä—É", "‚Üí –•340–†–£797"),
        ("H340PY797", "‚Üí –ù340–†–£797"),
        ("–∞123–≤—Å", "‚Üí –ê123–í–°797"),
        ("b567tx", "‚Üí –í567–¢–•797"),
        ("e234km", "‚Üí –ï234–ö–ú797"),
    ]
    
    text = "‚úÖ **–ü–†–ò–ú–ï–†–´ –ü–†–ê–í–ò–õ–¨–ù–´–• –ù–û–ú–ï–†–û–í:**\n\n"
    
    text += "üì± **–ß—Ç–æ –º–æ–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å (–±–æ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç):**\n"
    for input_ex, output in input_examples:
        text += f"‚Ä¢ `{input_ex}` {output}\n"
    
    text += "\nüéØ **–§–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤ –±–∞–∑–µ:**\n"
    for i, example in enumerate(examples[:5]):
        text += f"‚Ä¢ {example}\n"
    
    return text

def get_wrong_examples() -> str:
    """–ü—Ä–∏–º–µ—Ä—ã –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤"""
    return (
        "‚ùå **–ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ï –ù–û–ú–ï–†–ê:**\n"
        "‚Ä¢ –ê123–ë–í777 (–±—É–∫–≤–∞ –ë –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–æ–º–µ—Ä–∞—Ö –†–§)\n"
        "‚Ä¢ ABC123 (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)\n"
        "‚Ä¢ 123456 (—Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã)\n"
        "‚Ä¢ –ê–ë–í–ì–î–ï (—Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã)\n"
    )

def get_allowed_letters_explained() -> str:
    """–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö –±—É–∫–≤"""
    letters_info = [
        ("A/–ê", "–õ–∞—Ç–∏–Ω—Å–∫–∞—è A –∏–ª–∏ —Ä—É—Å—Å–∫–∞—è –ê"),
        ("B/–í", "–õ–∞—Ç–∏–Ω—Å–∫–∞—è B –∏–ª–∏ —Ä—É—Å—Å–∫–∞—è –í"),
        ("C/–°", "–õ–∞—Ç–∏–Ω—Å–∫–∞—è C –∏–ª–∏ —Ä—É—Å—Å–∫–∞—è –°"),
        ("E/–ï", "–õ–∞—Ç–∏–Ω—Å–∫–∞—è E –∏–ª–∏ —Ä—É—Å—Å–∫–∞—è –ï"),
        ("H/–ù", "–õ–∞—Ç–∏–Ω—Å–∫–∞—è H –∏–ª–∏ —Ä—É—Å—Å–∫–∞—è –ù (–≤–∞–∂–Ω–æ: H ‚Üí –ù)"),
        ("K/–ö", "–õ–∞—Ç–∏–Ω—Å–∫–∞—è K –∏–ª–∏ —Ä—É—Å—Å–∫–∞—è –ö"),
        ("M/–ú", "–õ–∞—Ç–∏–Ω—Å–∫–∞—è M –∏–ª–∏ —Ä—É—Å—Å–∫–∞—è –ú"),
        ("O/–û", "–õ–∞—Ç–∏–Ω—Å–∫–∞—è O –∏–ª–∏ —Ä—É—Å—Å–∫–∞—è –û"),
        ("P/–†", "–õ–∞—Ç–∏–Ω—Å–∫–∞—è P –∏–ª–∏ —Ä—É—Å—Å–∫–∞—è –†"),
        ("T/–¢", "–õ–∞—Ç–∏–Ω—Å–∫–∞—è T –∏–ª–∏ —Ä—É—Å—Å–∫–∞—è –¢"),
        ("X/–•", "–õ–∞—Ç–∏–Ω—Å–∫–∞—è X –∏–ª–∏ —Ä—É—Å—Å–∫–∞—è –• (–≤–∞–∂–Ω–æ: X ‚Üí –•)"),
        ("Y/–£", "–õ–∞—Ç–∏–Ω—Å–∫–∞—è Y –∏–ª–∏ —Ä—É—Å—Å–∫–∞—è –£ (–≤–∞–∂–Ω–æ: Y ‚Üí –£)"),
    ]
    
    text = "üî§ **–†–ê–ó–†–ï–®–Å–ù–ù–´–ï –ë–£–ö–í–´:**\n\n"
    text += "–ú–æ–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å —Ä—É—Å—Å–∫–∏–µ –∏–ª–∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –±—É–∫–≤—ã:\n"
    
    for letter, description in letters_info:
        text += f"‚Ä¢ {letter} - {description}\n"
    
    return text

# ========== –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø ==========

if __name__ == "__main__":
    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
    test_cases = [
        "x340py",
        "—Ö340—Ä—É",
        "H340PY797",
        "–∞123–≤—Å",
        "b567tx",
        "e234km",
        "X340PY",
        "h340py",
        "y123ab",
        "–ê123–í–°777",
        "–•340–†–£",
        "–í567 –¢–•-799",  # –° –ø—Ä–æ–±–µ–ª–æ–º –∏ –¥–µ—Ñ–∏—Å–æ–º
        "–æ234 —Å—Ä 797",  # –° –ø—Ä–æ–±–µ–ª–∞–º–∏
    ]
    
    print("üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–æ–º–µ—Ä–æ–≤:")
    print("=" * 50)
    
    for test in test_cases:
        normalized = normalize_car_number(test)
        is_valid, final_number, error = validate_car_number(test)
        
        print(f"–í–≤–æ–¥: '{test}'")
        print(f"  –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ: {normalized}")
        print(f"  –í–∞–ª–∏–¥–Ω–æ—Å—Ç—å: {'‚úÖ' if is_valid else '‚ùå'}")
        print(f"  –§–∏–Ω–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä: {final_number}")
        if error:
            print(f"  –û—à–∏–±–∫–∞: {error}")
        print()
